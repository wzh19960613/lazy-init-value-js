{
  "version": 3,
  "sources": ["..\\src\\index.ts"],
  "sourcesContent": [
    "export class LazyInitValueBase<T, INIT_FN> {\r\n    static autoFreeze = true\r\n\r\n    protected _value?: T\r\n    protected _initFn?: INIT_FN\r\n    protected _autoFreeze?: boolean\r\n\r\n    constructor(initFn: INIT_FN, autoFreeze?: boolean) {\r\n        this._initFn = initFn\r\n        this._autoFreeze = autoFreeze ?? LazyInitValue.autoFreeze\r\n    }\r\n\r\n    get inited() { return !this._initFn }\r\n\r\n    reset(initFn: INIT_FN) { this._initFn = initFn }\r\n\r\n    freeze() {\r\n        if (Object.isFrozen(this)) return\r\n        delete this._autoFreeze\r\n        Object.freeze(this)\r\n    }\r\n}\r\n\r\nexport class LazyInitValue<T> extends LazyInitValueBase<T, () => T> {\r\n    static get autoFreeze() { return LazyInitValueBase.autoFreeze }\r\n    static set autoFreeze(autoFreeze: boolean) { LazyInitValueBase.autoFreeze = autoFreeze }\r\n\r\n    constructor(initFn: () => T, autoFreeze?: boolean) { super(initFn, autoFreeze) }\r\n\r\n    get value() {\r\n        if (!this._initFn) return this._value as T\r\n        this._value = this._initFn()\r\n        delete this._initFn\r\n        if (this._autoFreeze) this.freeze()\r\n        return this._value\r\n    }\r\n}\r\n\r\nexport class LazyAsyncInitValue<T> extends LazyInitValueBase<T, () => Promise<T>> {\r\n    static get autoFreeze() { return LazyInitValueBase.autoFreeze }\r\n    static set autoFreeze(autoFreeze: boolean) { LazyInitValueBase.autoFreeze = autoFreeze }\r\n\r\n    protected _initing?: true\r\n    protected _resolvers?: ((value: T) => void)[] = []\r\n    protected _rejections?: ((reason: any) => void)[] = []\r\n\r\n    constructor(initFn: () => Promise<T>, autoFreeze?: boolean) { super(initFn, autoFreeze) }\r\n\r\n    get initing() { return this._initing ?? false }\r\n\r\n    _init_value() {\r\n        this._initing = true\r\n        this._initFn!().then(value => {\r\n            this._value = value\r\n            delete this._initFn\r\n            delete this._initing\r\n            for (const res of this._resolvers ?? []) res(value)\r\n            delete this._resolvers\r\n            delete this._rejections\r\n            if (this._autoFreeze) this.freeze()\r\n        }).catch(reason => {\r\n            delete this._initing\r\n            for (const rej of this._rejections ?? []) rej(reason)\r\n            delete this._resolvers\r\n            delete this._rejections\r\n        })\r\n    }\r\n\r\n    value() {\r\n        if (!this._initFn) return this._value as T\r\n        if (!this._resolvers) {\r\n            this._resolvers = []\r\n            this._rejections = []\r\n        }\r\n        const promise = new Promise<T>((resolve, reject) => {\r\n            this._resolvers!.push(resolve)\r\n            this._rejections!.push(reject)\r\n        })\r\n        if (!this._initing) this._init_value()\r\n        return promise\r\n    }\r\n\r\n    get value_sync() {\r\n        if (!this._initFn) return this._value\r\n        if (!this._initing) this._init_value()\r\n    }\r\n}"
  ],
  "mappings": "AAAO,MAAM,CAA8B,OAChC,YAAa,GAEV,OACA,QACA,YAEV,WAAW,CAAC,EAAiB,EAAsB,CAC/C,KAAK,QAAU,EACf,KAAK,YAAc,GAAc,EAAc,cAG/C,OAAM,EAAG,CAAE,OAAQ,KAAK,QAE5B,KAAK,CAAC,EAAiB,CAAE,KAAK,QAAU,EAExC,MAAM,EAAG,CACL,GAAI,OAAO,SAAS,IAAI,EAAG,OAC3B,OAAO,KAAK,YACZ,OAAO,OAAO,IAAI,EAE1B,CAEO,MAAM,UAAyB,CAA8B,WACrD,WAAU,EAAG,CAAE,OAAO,EAAkB,qBACxC,WAAU,CAAC,EAAqB,CAAE,EAAkB,WAAa,EAE5E,WAAW,CAAC,EAAiB,EAAsB,CAAE,MAAM,EAAQ,CAAU,KAEzE,MAAK,EAAG,CACR,IAAK,KAAK,QAAS,OAAO,KAAK,OAG/B,GAFA,KAAK,OAAS,KAAK,QAAQ,SACpB,KAAK,QACR,KAAK,YAAa,KAAK,OAAO,EAClC,OAAO,KAAK,OAEpB,CAEO,MAAM,UAA8B,CAAuC,WACnE,WAAU,EAAG,CAAE,OAAO,EAAkB,qBACxC,WAAU,CAAC,EAAqB,CAAE,EAAkB,WAAa,EAElE,SACA,WAAsC,CAAC,EACvC,YAA0C,CAAC,EAErD,WAAW,CAAC,EAA0B,EAAsB,CAAE,MAAM,EAAQ,CAAU,KAElF,QAAO,EAAG,CAAE,OAAO,KAAK,UAAY,GAExC,WAAW,EAAG,CACV,KAAK,SAAW,GAChB,KAAK,QAAS,EAAE,KAAK,KAAS,CAC1B,KAAK,OAAS,SACP,KAAK,eACL,KAAK,SACZ,QAAW,KAAO,KAAK,YAAc,CAAC,EAAG,EAAI,CAAK,EAGlD,UAFO,KAAK,kBACL,KAAK,YACR,KAAK,YAAa,KAAK,OAAO,EACrC,EAAE,MAAM,KAAU,CACf,OAAO,KAAK,SACZ,QAAW,KAAO,KAAK,aAAe,CAAC,EAAG,EAAI,CAAM,EACpD,OAAO,KAAK,kBACL,KAAK,YACf,EAGL,KAAK,EAAG,CACJ,IAAK,KAAK,QAAS,OAAO,KAAK,OAC/B,IAAK,KAAK,WACN,KAAK,WAAa,CAAC,EACnB,KAAK,YAAc,CAAC,EAExB,MAAM,EAAU,IAAI,QAAW,CAAC,EAAS,IAAW,CAChD,KAAK,WAAY,KAAK,CAAO,EAC7B,KAAK,YAAa,KAAK,CAAM,EAChC,EACD,IAAK,KAAK,SAAU,KAAK,YAAY,EACrC,OAAO,KAGP,WAAU,EAAG,CACb,IAAK,KAAK,QAAS,OAAO,KAAK,OAC/B,IAAK,KAAK,SAAU,KAAK,YAAY,EAE7C",
  "debugId": "2BDBB6CFDEEF711F64756E2164756E21",
  "names": []
}